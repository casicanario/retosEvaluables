<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reto 2 - Tienda Online</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .navbar {
            background-color: #2c3e50 !important;
        }
        .navbar-brand {
            color: white !important;
            font-weight: bold;
        }
        .product-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 20px;
            transition: transform 0.2s;
        }
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .product-image {
            width: 100%;
            height: 300px;
            object-fit: cover;
        }
        .product-info {
            padding: 15px;
        }
        .product-price {
            font-size: 1.2rem;
            font-weight: bold;
            color: #e74c3c;
        }
        .btn-add-cart {
            background-color: #3498db;
            border: none;
            width: 100%;
        }
        .btn-add-cart:hover {
            background-color: #2980b9;
        }
        .cart-sidebar {
            position: fixed;
            right: -400px;
            top: 0;
            width: 400px;
            height: 100vh;
            background: white;
            box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            transition: right 0.3s ease;
            z-index: 1050;
            overflow-y: auto;
        }
        .cart-sidebar.show {
            right: 0;
        }
        .cart-header {
            background-color: #2c3e50;
            color: white;
            padding: 20px;
        }
        .cart-item {
            border-bottom: 1px solid #eee;
            padding: 15px;
        }
        .cart-item img {
            width: 60px;
            height: 60px;
            object-fit: cover;
        }
        .cart-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.5);
            display: none;
            z-index: 1040;
        }
        .cart-badge {
            background-color: #e74c3c;
            color: white;
            border-radius: 50%;
            padding: 2px 8px;
            font-size: 0.8rem;
            position: absolute;
            top: -8px;
            right: -8px;
        }
        .filter-section {
            background-color: #f8f9fa;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-tshirt me-2"></i>
                Moda Store
            </a>
            <div class="ms-auto">
                <button class="btn btn-outline-light position-relative" id="cartBtn">
                    <i class="fas fa-shopping-cart"></i>
                    Carrito
                    <span class="cart-badge" id="cartCount">0</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mt-4">
        <!-- Filtros -->
        <div class="filter-section">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <h4>Filtrar productos</h4>
                </div>
                <div class="col-md-6">
                    <select class="form-select" id="categoryFilter">
                        <option value="all">Todas las categorías</option>
                        <option value="pantalones">Pantalones</option>
                        <option value="vestidos">Vestidos</option>
                        <option value="camisetas">Camisetas</option>
                        <option value="cardigans">Cardigans</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Products Grid -->
        <div class="row" id="productsContainer">
            <!-- Los productos se cargarán aquí con JavaScript -->
        </div>
    </div>

    <!-- Cart Overlay -->
    <div class="cart-overlay" id="cartOverlay"></div>

    <!-- Cart Sidebar -->
    <div class="cart-sidebar" id="cartSidebar">
        <div class="cart-header d-flex justify-content-between align-items-center">
            <h4><i class="fas fa-shopping-cart me-2"></i>Carrito de Compras</h4>
            <button class="btn btn-outline-light btn-sm" id="closeCart">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div id="cartItems">
            <!-- Los items del carrito se cargarán aquí -->
        </div>
        <div class="p-3 bg-light">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <strong>Total: <span id="cartTotal">€0.00</span></strong>
            </div>
            <button class="btn btn-success w-100" id="checkoutBtn">
                <i class="fas fa-credit-card me-2"></i>
                Finalizar Compra
            </button>
            <button class="btn btn-outline-danger w-100 mt-2" id="clearCartBtn">
                <i class="fas fa-trash me-2"></i>
                Vaciar Carrito
            </button>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Datos de productos
        const products = [
            {
                id: 1,
                name: "Pantalón Suelto Gris",
                price: 45.99,
                category: "pantalones",
                image: "https://images.unsplash.com/photo-1594633312681-425c7b97ccd1?w=400&h=400&fit=crop&crop=center",
                description: "Cómodo pantalón suelto perfecto para el día a día."
            },
            {
                id: 2,
                name: "Vestido Túnico",
                price: 52.99,
                category: "vestidos",
                image: "https://images.unsplash.com/photo-1515372039744-b8f02a3ae446?w=400&h=400&fit=crop&crop=center",
                description: "Elegante vestido túnico ideal para cualquier ocasión."
            },
            {
                id: 3,
                name: "Falda Midi Print",
                price: 38.50,
                category: "vestidos",
                image: "https://images.unsplash.com/photo-1583496661160-fb5886a13d77?w=400&h=400&fit=crop&crop=center",
                description: "Falda midi con estampado moderno y juvenil."
            },
            {
                id: 4,
                name: "Cardigan Largo Rayado",
                price: 65.00,
                category: "cardigans",
                image: "https://images.unsplash.com/photo-1434389677669-e08b4cac3105?w=400&h=400&fit=crop&crop=center",
                description: "Cardigan largo y cómodo con patrón de rayas."
            },
            {
                id: 5,
                name: "Top Estampado Zebra",
                price: 29.99,
                category: "camisetas",
                image: "https://images.unsplash.com/photo-1551488831-00ddcb6c6bd3?w=400&h=400&fit=crop&crop=center",
                description: "Top moderno con estampado de zebra muy trendy."
            },
            {
                id: 6,
                name: "Vestido Beige Elegante",
                price: 78.50,
                category: "vestidos",
                image: "https://images.unsplash.com/photo-1496747611176-843222e1e57c?w=400&h=400&fit=crop&crop=center",
                description: "Vestido beige elegante perfecto para eventos especiales."
            },
            {
                id: 7,
                name: "Crop Top Blanco",
                price: 24.99,
                category: "camisetas",
                image: "https://images.unsplash.com/photo-1571781926291-c477ebfd024b?w=400&h=400&fit=crop&crop=center",
                description: "Crop top básico en color blanco, muy versátil."
            },
            {
                id: 8,
                name: "Pantalón Negro Ajustado",
                price: 42.00,
                category: "pantalones",
                image: "https://images.unsplash.com/photo-1506629905477-6549235aa4b8?w=400&h=400&fit=crop&crop=center",
                description: "Pantalón negro ajustado, perfecto para looks formales."
            }
        ];

        let cart = [];

        // Funciones principales
        $(document).ready(function() {
            displayProducts(products);
            updateCartUI();
            
            // Event listeners
            $('#cartBtn').click(function() {
                $('#cartSidebar').addClass('show');
                $('#cartOverlay').show();
            });

            $('#closeCart, #cartOverlay').click(function() {
                $('#cartSidebar').removeClass('show');
                $('#cartOverlay').hide();
            });

            $('#categoryFilter').change(function() {
                const selectedCategory = $(this).val();
                if (selectedCategory === 'all') {
                    displayProducts(products);
                } else {
                    const filteredProducts = products.filter(product => 
                        product.category === selectedCategory
                    );
                    displayProducts(filteredProducts);
                }
            });

            $('#clearCartBtn').click(function() {
                clearCart();
            });

            $('#checkoutBtn').click(function() {
                if (cart.length === 0) {
                    alert('El carrito está vacío');
                    return;
                }
                
                const total = getCartTotal();
                alert(`Compra realizada por €${total.toFixed(2)}. ¡Gracias por tu compra!`);
                clearCart();
                $('#cartSidebar').removeClass('show');
                $('#cartOverlay').hide();
            });
        });

        function displayProducts(productsToShow) {
            const container = $('#productsContainer');
            container.empty();

            productsToShow.forEach(product => {
                const productCard = `
                    <div class="col-md-3 col-sm-6">
                        <div class="product-card">
                            <img src="${product.image}" alt="${product.name}" class="product-image">
                            <div class="product-info">
                                <h5>${product.name}</h5>
                                <p class="text-muted small">${product.description}</p>
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <span class="product-price">€${product.price}</span>
                                </div>
                                <button class="btn btn-primary btn-add-cart" onclick="addToCart(${product.id})">
                                    <i class="fas fa-cart-plus me-2"></i>Añadir al carrito
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                container.append(productCard);
            });
        }

        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            const existingItem = cart.find(item => item.id === productId);

            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({...product, quantity: 1});
            }

            updateCartUI();
            
            // Animación de confirmación
            $(`button[onclick="addToCart(${productId})"]`)
                .html('<i class="fas fa-check me-2"></i>¡Añadido!')
                .removeClass('btn-primary')
                .addClass('btn-success');
            
            setTimeout(() => {
                $(`button[onclick="addToCart(${productId})"]`)
                    .html('<i class="fas fa-cart-plus me-2"></i>Añadir al carrito')
                    .removeClass('btn-success')
                    .addClass('btn-primary');
            }, 1000);
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCartUI();
        }

        function updateQuantity(productId, change) {
            const item = cart.find(item => item.id === productId);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeFromCart(productId);
                }
            }
            updateCartUI();
        }

        function updateCartUI() {
            const cartCount = cart.reduce((total, item) => total + item.quantity, 0);
            $('#cartCount').text(cartCount);

            const cartItemsContainer = $('#cartItems');
            cartItemsContainer.empty();

            if (cart.length === 0) {
                cartItemsContainer.append('<div class="p-4 text-center text-muted">El carrito está vacío</div>');
            } else {
                cart.forEach(item => {
                    const cartItem = `
                        <div class="cart-item">
                            <div class="row align-items-center">
                                <div class="col-3">
                                    <img src="${item.image}" alt="${item.name}" class="img-fluid rounded">
                                </div>
                                <div class="col-6">
                                    <h6 class="mb-1">${item.name}</h6>
                                    <small class="text-muted">€${item.price}</small>
                                </div>
                                <div class="col-3 text-end">
                                    <div class="btn-group-vertical btn-group-sm">
                                        <button class="btn btn-outline-primary btn-sm" onclick="updateQuantity(${item.id}, 1)">
                                            <i class="fas fa-plus"></i>
                                        </button>
                                        <span class="px-2 py-1 bg-light text-center">${item.quantity}</span>
                                        <button class="btn btn-outline-primary btn-sm" onclick="updateQuantity(${item.id}, -1)">
                                            <i class="fas fa-minus"></i>
                                        </button>
                                    </div>
                                    <button class="btn btn-outline-danger btn-sm mt-1 w-100" onclick="removeFromCart(${item.id})">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                    cartItemsContainer.append(cartItem);
                });
            }

            const total = getCartTotal();
            $('#cartTotal').text(`€${total.toFixed(2)}`);
        }

        function getCartTotal() {
            return cart.reduce((total, item) => total + (item.price * item.quantity), 0);
        }

        function clearCart() {
            cart = [];
            updateCartUI();
        }
    </script>
</body>
</html>